---
title: "My Shiny Project"
author: "Haijing Wang"
date: "1/1/2021"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
require(ggplot2)
```

## Summary

My Shiny App is hosted [here](https://haijingwang.shinyapps.io/myshiny/).   

It has four components:  
1. Date and time when you load the page  
2. Description of what the app does and how to use it  
3. Slider for user to select range of weights of cars  
4. Scatter plot to visualize mpg~wt colored by cylinder number, and regression line with confidence band for each cylinder group.  

## Explanation of ui.R
ui.R defines page layout and UI components.   
This app has a slider input "slider1", a text output "mydate" and a plot output "mpgPlot".    
Code snippet (Not everything due to space limit)  
```{r eval=FALSE, echo=TRUE}
shinyUI(fluidPage(
    # mydate is generated by server.R
    p(textOutput("mydate")),
    sliderInput("slider1", label = h3("Weight(tons) Range"), min = 1, 
                        max = 6, step=0.25, width='60%', value = c(1, 6)),
    verbatimTextOutput("range"),
    # Show a plot of the generated distribution
    mainPanel( plotOutput("mpgPlot"))
    )
)
```

## Explantion of server.R
1. Slider input value can be retrieved by calling **input$slider1**
2. We need to define a reactive function to read new slider range, and filter mtcars data based on the range. Some key code snippet:   
```{r eval=FALSE, echo=TRUE}
shinyServer(function(input, output) {
    filtered.mtcars <- reactive({
        min <- input$slider1[1]
        max <- input$slider1[2]
        mtcars[mtcars$wt >= min & mtcars$wt <= max, ]
    })
    output$mpgPlot <- renderPlot({
        p <- ggplot(data=filtered.mtcars(), aes(x=wt, y=mpg, color=cyl)) + geom_point() + geom_smooth(method="auto", se=TRUE, fullrange=FALSE, level=0.9)
        p
    })
})
```

## Main Plot
The plot looks like the following. And it will re-render based on slider range selection.  
```{r mtcars, echo=FALSE}
mtcars$cyl <- as.factor(mtcars$cyl)
p <- ggplot(mtcars, aes(x=wt, y=mpg, color=cyl)) + geom_point() 
p <- p + geom_smooth(method="loess",    formula='y~x', se=TRUE,  fullrange=FALSE, level=0.9)
p
```

